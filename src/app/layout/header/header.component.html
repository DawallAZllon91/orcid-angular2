<header class="container" [ngClass]="{ 'fixed-header-mode': mobileMenuState }">
  <div class="row baseline">
    <div routerLink="/" class="col l5 m8 s4 middle logo-menu-container">
      <div class="logo-container">
        <img src="./assets/vectors/orcid.logo.svg" />
        <div
          *ngIf="platform.columns12"
          i18n="#sentenceCase@@confirm-oauth-access.connectingresearchandresearchers"
        >
          Connecting research and researchers
        </div>
      </div>
      <div class="col no-gutters">
        <div *ngIf="!platform.columns12" class="row middle no-gutters">
          <div *ngIf="mobileMenuState" class="col no-gutters">
            <app-language class="col no-gutters"></app-language>
          </div>
          <div *ngIf="!mobileMenuState" class="col no-gutters">
            <app-user-menu></app-user-menu>
          </div>

          <app-menu-icon
            (click)="mobileMenuState = !mobileMenuState"
            [isOpen]="mobileMenuState"
          ></app-menu-icon>
        </div>
      </div>
    </div>
    <div
      class="col l6 offset-l1 m8 s4 middle no-gutters"
      *ngIf="platform.columns12"
    >
      <app-search></app-search>
    </div>
  </div>
</header>

<div class="col l5 offset-l3 m8 s4 middle" *ngIf="!platform.columns12">
  <app-search></app-search>
</div>

<!-- MAIN MENU -->
<nav (mouseleave)="mouseLeave()" *ngIf="mobileMenuState || platform.columns12">
  <div class="top-bar">
    <div class="menu-container" [ngClass]="{ container: platform.columns12 }">
      <ng-template #recursiveList let-list let-parents="parents">
        <ul class="row" *ngIf="!(platform.columns12 && parents.length > 1)">
          <li class="col no-gutters" *ngFor="let item of list">
            <button
              *ngIf="checkMenuItemRequirements(item.requirements) === true"
              [ngClass]="{
                active: item.activeRoute === currentRoute
              }"
              mat-button
              (click)="click(parents.concat(item.id), item)"
              (mouseenter)="mouseEnter(parents.concat(item.id))"
            >
              <div class="button-box">
                <div>{{ item.label | uppercase }}</div>
                <mat-icon *ngIf="!platform.columns12 && item.buttons.length">{{
                  item.hover ? 'arrow_drop_up' : 'arrow_drop_down'
                }}</mat-icon>
              </div>
            </button>
            <ng-container *ngIf="item.hover && item.buttons.length">
              <ng-container
                *ngTemplateOutlet="
                  recursiveList;
                  context: {
                    $implicit: item.buttons,
                    parents: parents.concat(item.id)
                  }
                "
              ></ng-container>
            </ng-container>
          </li>
        </ul>
      </ng-template>

      <ng-container
        *ngTemplateOutlet="
          recursiveList;
          context: { $implicit: menu, parents: [] }
        "
      ></ng-container>
      <ul class="row" *ngIf="checkMenuItemRequirements({ desktop: false })">
        <li
          class="col no-gutters"
          *ngIf="checkMenuItemRequirements({ logging: false })"
        >
          <button mat-stroked-button class="sign-in-button">
            <ng-container i18n="#upperCase@@header.signin">SIGN IN</ng-container
            >/<ng-container i18n="#upperCase@@header.register"
              >REGISTER</ng-container
            >
          </button>
        </li>
        <li
          class="col no-gutters"
          *ngIf="checkMenuItemRequirements({ logging: true })"
        >
          <button mat-stroked-button class="sign-in-button">
            <ng-container i18n="#upperCase@@public-layout.sign_out"
              >SIGN OUT</ng-container
            >
          </button>
        </li>
      </ul>
    </div>
  </div>
</nav>
<div class="statics container">
  <div class="row">
    <div class="col l5 m8 s4 push-l7" *ngIf="togglz">
      <div class="row middle mat-caption">
        {{ togglz.messages.LIVE_IDS }}
        <ng-container i18n="@@public-layout.amount_ids"
          >ORCID iDs and counting.</ng-container
        >
        <a i18n="@@public-layout.see_more" href="/statistics"
          >See more statics</a
        >
      </div>
    </div>
  </div>
</div>
