<main>
  <div class="container ">
    <div class="row space-around" [formGroup]="recoveryForm">
      <div class="col l6 m6 s4  ">
        <h1 class="row display-1 " i18n="@@ngOrcid.passwordAndOrcid">
          Password and ORCID iD Recovery
        </h1>
        <div class="form-container" [hidden]="submitted">
          <p
            class="row mat-caption"
            i18n="@@ngOrcid.didYouForget"
            id="didYouForget"
          >
            Did you forget your password or ORCID iD?
          </p>
          <mat-chip-list
            aria-labelledby="didYouForget"
            formControlName="type"
            formControlName="type"
            required
          >
            <mat-chip
              value="resetPassword"
              class="orcid-outline-chip"
              #passwordChip="matChip"
              (click)="passwordChip.toggleSelected(true)"
              i18n="@@check_password_modal.password"
              >Password</mat-chip
            >
            <mat-chip
              value="remindOrcidId"
              #emailChip="matChip"
              (click)="emailChip.toggleSelected(true)"
              class="orcid-outline-chip"
              i18n="@@common.orcid_id"
              >ORCID ID</mat-chip
            >
          </mat-chip-list>
          <mat-error
            *ngIf="
              typeFormControl.hasError('required') && typeFormControl.touched
            "
            [@transitionMessages]="_subscriptAnimationState"
            class="chipsError mat-caption"
            i18n="@@ngOrcid.pleaseChooseRecovery"
            >Please choose a recovery option</mat-error
          >

          <mat-form-field appearance="fill" class="row ">
            <mat-label i18n="@@oauth_sign_up.labelemail">Email</mat-label>
            <input matInput formControlName="email" required />

            <mat-error
              i18n="@@Email.resendClaim.invalidEmail"
              *ngIf="
                emailFormControl.hasError('required') ||
                emailFormControl.hasError('email')
              "
              >Please enter a valid email address</mat-error
            >

            <mat-error
              *ngFor="
                let backendError of emailFormControl.errors
                  ? emailFormControl.errors['backendErrors']
                  : []
              "
              >{{ backendError }}</mat-error
            >
          </mat-form-field>

          <button
            mat-raised-button
            (click)="onSubmit()"
            color="primary"
            class="row"
            type="submit"
            [disabled]="loading"
            i18n="@@ngOrcid.recoverAccountDetails"
          >
            RECOVER ACCOUNT DETAILS
          </button>
          <mat-progress-bar
            *ngIf="loading"
            mode="indeterminate"
          ></mat-progress-bar>
        </div>
        <div class="success-container" *ngIf="submitted" role="alert">
          <p>
            <ng-container i18n="@@orcid.frontend.reset.password.email_success_1"
              >We have sent a message to</ng-container
            >
            <strong>{{ emailFormControl.value }}</strong>
            <ng-container i18n="@@orcid.frontend.reset.password.email_success_2"
              >from reset@notify.orcid.org.</ng-container
            >
            <ng-container i18n="@@ngOrcid.youCanNow">You can now</ng-container>
            <a
              i18n="@@ngOrcid.returnToLoginPage"
              (click)="navigateTo('/signin')"
              >return to the login page.</a
            >
          </p>
          <p>
            <ng-container i18n="@@orcid.frontend.reset.password.email_success_3"
              >If you do not receive a message within 5 minutes, please check
              your spam folder. If you still do not see a message,
              then</ng-container
            >

            <a
              i18n="@@orcid.frontend.reset.password.email_success_4"
              (click)="navigateTo('/help/contact-us')"
              >contact us</a
            >.
          </p>
        </div>
      </div>
    </div>
  </div>
</main>
