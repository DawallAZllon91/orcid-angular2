<main>
  <div class="container ">
    <div class="row space-around" [formGroup]="recoveryForm">
      <div class="col l6 m6 s4  ">
        <h1 class="row display-1 ">Password and ORCID iD Recovery</h1>
        <div class="form-container" [hidden]="submited">
          <p class="row mat-caption">
            Did you forget your password or ORCID iD?
          </p>

          <mat-chip-list
            aria-label="Fish selection"
            formControlName="type"
            (change)="chipsChange($event)"
            formControlName="type"
          >
            <mat-chip
              value="resetPassword"
              class="orcid-outline-chip"
              #passwordChip="matChip"
              (click)="passwordChip.toggleSelected(true)"
              >Password</mat-chip
            >
            <mat-chip
              value="remindOrcidId"
              #emailChip="matChip"
              (click)="emailChip.toggleSelected(true)"
              class="orcid-outline-chip"
              >ORCID ID</mat-chip
            >
          </mat-chip-list>
          <mat-error
            *ngIf="
              typeFormControl.hasError('required') && typeFormControl.touched
            "
            [@transitionMessages]="_subscriptAnimationState"
            class="chipsError mat-caption"
          >
            Please choose a recovery option
          </mat-error>

          <mat-form-field appearance="fill" class="row ">
            <mat-label>Email</mat-label>
            <input matInput formControlName="email" />

            <mat-error
              *ngIf="
                emailFormControl.hasError('required') ||
                emailFormControl.hasError('email')
              "
            >
              Please enter a valid email address
            </mat-error>

            <mat-error
              *ngFor="
                let backendError of emailFormControl.errors
                  ? emailFormControl.errors['backendErrors']
                  : []
              "
            >
              {{ backendError }}
            </mat-error>
          </mat-form-field>

          <button
            mat-raised-button
            (click)="onSubmit()"
            color="primary"
            class="row"
            type="submit"
            [disabled]="loading"
          >
            RECOVER ACCOUNT DETAILS
          </button>
          <mat-progress-bar
            *ngIf="loading"
            mode="indeterminate"
          ></mat-progress-bar>
        </div>
        <div class="success-container" *ngIf="submited">
          <p>
            <ng-container>We have sent a message to </ng-container>
            <strong>{{ emailFormControl.value }} </strong>

            <ng-container
              >from reset@notify.orcid.org. You can now</ng-container
            >
            <a>return to the login page</a>.
          </p>
          <p>
            <ng-container>
              If you do not receive a message within 5 minutes, please check
              your spam folder. If you still do not see a message, then
            </ng-container>
            <a>contact us</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</main>
